(this["webpackJsonpcarbon-intensity"]=this["webpackJsonpcarbon-intensity"]||[]).push([[0],{54:function(t,n,e){"use strict";e.r(n);var r=e(0),a=e(1),i=e.n(a),c=e(23),o=e.n(c),s=e(5),u=e.n(s),l=e(7),f=e(6),d=e(10),b=e.n(d),p=function(){var t=Object(l.a)(u.a.mark((function t(n){var e,r,a,i,c,o,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n.replace(/\s/g,""),t.next=4,b.a.get("https://api.postcodes.io/postcodes/".concat(e));case 4:return r=t.sent,a=r.data.result,i=a.admin_district,c=a.outcode,o=a.latitude,s=a.longitude,t.abrupt("return",{admin_district:i,outcode:c,latitude:o,longitude:s});case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(n){return t.apply(this,arguments)}}(),h=function(){var t=Object(l.a)(u.a.mark((function t(n){var e,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=(new Date).toISOString(),t.next=4,b.a.get("https://api.carbonintensity.org.uk/regional/intensity/".concat(e,"/fw48h/postcode/").concat(n));case 4:return r=t.sent,t.abrupt("return",r.data.data.data[0]);case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(n){return t.apply(this,arguments)}}(),j={fetchLocationData:p,fetchPollutionData:function(){var t=Object(l.a)(u.a.mark((function t(n,e){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.get("https://cors-anywhere.herokuapp.com/http://api.openweathermap.org/data/2.5/air_pollution?lat=".concat(n,"&lon=").concat(e,"&appid=").concat("3d1641233d5dc6224b739cf77d08866e"));case 3:return r=t.sent,t.abrupt("return",r.data.list[0]);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(n,e){return t.apply(this,arguments)}}(),fetchEnergeyData:h},x=e(2),v=e(3);function m(){var t=Object(x.a)(["\n  body {\n    background: linear-gradient(#70b5f2, #298adf) fixed no-repeat;\n    font-family: 'Inder', sans-serif;\n    color: #fff;\n  }\n  \n  h1 {\n    text-align: center;\n    font-size: 4rem;\n  }\n\n  h2 {\n    font-size: 2rem;\n  }\n\n  h3 {\n    font-size: 1.5rem;\n  }\n\n  h4 {\n    font-size: 1.4rem;\n    font-weight: 500;\n  }\n\n  * {\n    padding: 0;\n    margin: 0;\n    box-sizing: border-box;\n  }\n"]);return m=function(){return t},t}var O=Object(v.a)(m());function g(){var t=Object(x.a)(["\n  font-size: 0.6em;\n  text-align: center;\n  margin-top: 0.5rem;\n"]);return g=function(){return t},t}function y(){var t=Object(x.a)(["\n  border: none;\n  padding: 0.6rem 1em;\n  font-size: 1.1em;\n  border-radius: 35px 0 0 35px;\n  width: 6.5em;\n  color: #5c5c5c;\n  caret-color: #8f8f8f;\n"]);return y=function(){return t},t}function w(){var t=Object(x.a)(["\n  border: none;\n  background-color: #85d018;\n  color: #fff;\n  padding: 0.3em 0.5em;\n  cursor: pointer;\n  border-radius: 0 35px 35px 0;\n  font-size: 0.8em;\n"]);return w=function(){return t},t}function k(){var t=Object(x.a)(["\n  position: absolute;\n  top: ",";\n  left: 50%;\n  font-size: ",";\n  transform: translate(-50%);\n  transition: 1s;\n"]);return k=function(){return t},t}var z=/^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z]))))\s?[0-9][A-Za-z]{2})$/,S=v.b.div(k(),(function(t){return t.style.top}),(function(t){return t.style.fontSize})),A=v.b.button(w()),C=v.b.input(y()),P=v.b.div(g()),D=function(t){var n=t.setLocationData,e=t.setSubmitted,i=Object(a.useRef)(null),c=Object(a.useState)(""),o=Object(f.a)(c,2),s=o[0],d=o[1],b=Object(a.useState)(""),p=Object(f.a)(b,2),h=p[0],x=p[1],v=Object(a.useState)({top:"30vh",fontSize:"1.8rem",width:"200px"}),m=Object(f.a)(v,2),O=m[0],g=m[1];Object(a.useEffect)((function(){i.current.focus()}),[]);var y=function(){var t=Object(l.a)(u.a.mark((function t(r){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),t.prev=1,z.test(h)){t.next=4;break}throw"Please enter a full, valid UK postcode";case 4:return t.next=6,j.fetchLocationData(h);case 6:a=t.sent,d(""),g({top:"40px",fontSize:"1.2rem",width:"150px"}),n(a),e(!0),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(1),console.error(t.t0),d(t.t0),setTimeout((function(){return d("")}),4e3);case 18:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(n){return t.apply(this,arguments)}}();return Object(r.jsxs)(S,{style:O,children:[Object(r.jsxs)("form",{style:{display:"flex",justifyContent:"center"},onSubmit:function(t){return y(t)},autoComplete:"off",children:[Object(r.jsx)(C,{ref:i,"aria-label":"post-code",type:"text",name:"postCode",placeholder:"Postcode",value:h,onChange:function(t){return function(t){x(t.target.value.toUpperCase())}(t)}}),Object(r.jsx)(A,{children:"Submit"})]}),s&&Object(r.jsxs)(P,{children:[Object(r.jsx)("i",{class:"fas fa-exclamation-triangle"})," ",Object(r.jsx)("span",{children:s})]})]})},T=function(t){var n=t.data,e=t.chartColours,i=Object(a.useRef)(null);Object(a.useEffect)((function(){var t=i.current.getContext("2d");c(t)}),[n]);var c=function(t){s(t);var e=0;n.forEach((function(n){o(t,e,n),e+=n.radians}))},o=function(t,n,r){var a=r.label,c=r.value,o=r.radians,s=i.current,u=s.width/2,l=s.height/2,f=s.height/2*.75,d=n+o;t.beginPath(),t.moveTo(u,l),t.arc(u,l,f,n,d,!1),t.closePath(),t.fillStyle=e[a],t.fill();var b=n+(d-n)/2,p=1.1*f,h=u+p*Math.cos(b),j=l+p*Math.sin(b);t.font=".9rem arial",t.fontWeight="400",t.fillStyle="#fff",t.textAlign=h<u?"right":"left",t.fillText("".concat(a,": ").concat(c,"%"),h,j)},s=function(t){var n=i.current;t.clearRect(0,0,n.width,n.height)};return Object(r.jsx)("div",{children:Object(r.jsx)("canvas",{ref:i,width:"520",height:"400"})})},E=e(27),I=e(9),M=function(t){var n=t.data,e=t.headings,i=Object(I.useMediaQuery)({maxWidth:800});return Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:i?"80%":"30%",margin:"0 .5rem"},children:[Object(r.jsx)("div",{children:Object(r.jsx)("h4",{children:e[0]})}),Object(r.jsx)("div",{style:{textAlign:"right"},children:Object(r.jsx)("h4",{children:e[1]})}),n.map((function(t){return Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("div",{children:Object(E.capitalize)(t[0])}),Object(r.jsx)("div",{style:{textAlign:"right"},children:t[1]})]})}))]})},R=function(t){var n=t.children,e=Object(I.useMediaQuery)({maxWidth:800});return Object(r.jsx)("div",{style:{display:"flex",flexDirection:e?"column":"row",justifyContent:e?"center":"space-between",alignItems:e?"center":"stretch"},children:n})};function Z(){var t=Object(x.a)(["\n  border-top: 1px solid #fff;\n  padding: 0.5rem 0;\n  animation: ",";\n  animation-duration: 0.5s;\n  animation-iteration-count: 1;\n  animation-timing-function: ease-out;\n"]);return Z=function(){return t},t}function _(){var t=Object(x.a)(["\n  0% {margin-left: -100vw;}\n  100% {margin: 0;} \n"]);return _=function(){return t},t}var F={biomass:"#79db88",solar:"#ffb555",wind:"#a8d6ff",hydro:"#00abff",coal:"#443636",nuclear:"#5de6c6",imports:"#e65d5d",gas:"#8d7cdf",other:"#eb2bee"},W=Object(v.c)(_()),L=v.b.section(Z(),W),J=function(t){var n=t.data,e=Object(a.useCallback)((function(){var t=n.generationmix.filter((function(t){return t.perc>.5})),e=t.reduce((function(t,n){return t+n.perc}),0);return t.map((function(t){return{value:t.perc,label:t.fuel,radians:t.perc/e*(2*Math.PI)}}))}),[n]),i=Object(a.useCallback)((function(){return n.generationmix.sort((function(t,n){return t.perc<n.perc})).map((function(t){return[t.fuel,t.perc]}))}),[n]);return Object(r.jsxs)(L,{children:[Object(r.jsxs)("header",{style:{textAlign:"center"},children:[Object(r.jsx)("h3",{children:"Energy Overview"}),Object(r.jsxs)("p",{children:["Carbon Intensity:"," ","".concat(n.intensity.forecast," (").concat(n.intensity.index,")")]})]}),Object(r.jsxs)(R,{children:[Object(r.jsx)(M,{headings:["Fuel source","%"],data:i()}),Object(r.jsx)(T,{data:e(),chartColours:F})]})]})};function G(){var t=Object(x.a)(["\n  height: 100%;\n  width: 100%;\n\n  & div {\n    width: 20px;\n    height: 20px;\n    background: #fff;\n    position: relative;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    animation: "," 1.8s linear infinite;\n  }\n\n  & div:nth-child(2) {\n    transform: translate(-50%, -150%);\n    animation-delay: -0.9s;\n  }\n"]);return G=function(){return t},t}function H(){var t=Object(x.a)(["\n  0% {left: 50%; top: 0px; border-radius: 50% 50% 50% 0;}\n  25% {left: 100%; top: 50%; border-radius: 0 50% 50% 50%;}\n  50% {left: 50%; top: 100%; border-radius: 50% 0 50% 50%;}\n  75% {left: 0%; top: 50%; border-radius: 50% 50% 0 50%; }\n  100% {left: 50%; top: 0px; border-radius: 50% 50% 50% 0;}\n"]);return H=function(){return t},t}var Q=Object(v.c)(H()),q=v.b.div(G(),Q),N=function(){return Object(r.jsxs)("div",{style:{position:"fixed",bottom:"50%",left:"50%",transform:"translate(-50%)",textAlign:"center"},children:[Object(r.jsx)("div",{style:{width:"100px",height:"100px",margin:"auto"},children:Object(r.jsxs)(q,{children:[Object(r.jsx)("div",{}),Object(r.jsx)("div",{})]})}),Object(r.jsx)("div",{style:{marginTop:"40px",fontSize:"1.4rem"},children:Object(r.jsx)("span",{children:"Working on it..."})})]})},U=function(t){var n=t.data,e=t.colours,i=Object(a.useRef)(null),c=n.reduce((function(t,n){return n.value>t?Math.ceil((n.value+1)/10*10):t}),0),o=30;Object(a.useEffect)((function(){var t=i.current.getContext("2d");s(t)}),[n]);var s=function(t){l(t);var e=10+70*n.length,r=i.current.height-o;t.font=".9rem arial",t.fontWeight="400",t.fillStyle="#fff",t.strokeStyle="#fff",t.textAlign="right",t.beginPath(),t.moveTo(o,r+1),t.lineTo(e+25,r+1),t.stroke(),t.beginPath(),t.moveTo(o,1),t.lineTo(o,r),t.stroke();for(var a=1;a>=0;a-=.15){var s=Math.round(c*a),f=r-r*a;t.fillText(s,25,f)}var d=40;n.forEach((function(n){u(t,r,d,n),d+=70}))},u=function(t,n,r,a){var s=i.current,u=a.value/c*100/100*n,l=r,f=s.height-(u+o);t.fillStyle=e[a.label],t.fillRect(l,f,60,u);var d=l+30,b=f+u+20;t.textAlign="center",t.fillStyle="#fff",t.fillText("".concat(a.label),d,b)},l=function(t){var n=i.current;t.clearRect(0,0,n.width,n.height)};return Object(r.jsx)("canvas",{ref:i,width:"520",height:"400"})};function V(){var t=Object(x.a)(["\n  border-top: 1px solid #fff;\n  padding: 0.5rem 0;\n  animation: ",";\n  animation-duration: 0.5s;\n  animation-iteration-count: 1;\n  animation-timing-function: ease-out;\n"]);return V=function(){return t},t}function Y(){var t=Object(x.a)(["\n  0% {margin-right: -100vw;}\n  100% {margin: 0;} \n"]);return Y=function(){return t},t}var B={no:"#79db88",no2:"#ffb555",o3:"#a8d6ff",so2:"#0a5e80",pm2_5:"#443636",pm10:"#a166f7",nh3:"#e65d5d"},K={1:"Good",2:"Fair",3:"Moderate",4:"Poor",5:"Very Poor"},X={co:"Carbon monnoxide",no:"Nitrous oxide",no2:"Nitrous dioxide",o3:"Ozone",so2:"Sulphur dioxide",pm2_5:"Fine particulates",pm10:"Coarse particulates",nh3:"Ammonia"},$=Object(v.c)(Y()),tt=v.b.section(V(),$),nt=function(t){var n=t.data,e=Object(a.useCallback)((function(){return Object.keys(n.components).filter((function(t){return"co"!==t&&"o3"!==t})).map((function(t){return{label:t,value:n.components[t]}})).sort((function(t,n){return t.value<n.value}))}),[n]),i=Object(a.useCallback)((function(){return Object.entries(n.components).map((function(t){var n=Object(f.a)(t,2),e=n[0],r=n[1];return[X[e],r]}))}),[n]);return Object(r.jsxs)(tt,{children:[Object(r.jsxs)("header",{style:{textAlign:"center"},children:[Object(r.jsx)("h3",{children:"Pollution Overview"}),Object(r.jsxs)("p",{children:["Air Quality Index: ","".concat(n.main.aqi," (").concat(K[n.main.aqi],")")]})]}),Object(r.jsxs)(R,{children:[Object(r.jsx)(U,{data:e(),colours:B}),Object(r.jsx)(M,{headings:["Pollutant","\u03bcg/m\xb3"],data:i()})]})]})},et=function(t){return Object(r.jsx)("div",{style:{position:t.submitted?"block":"absolute",top:t.submitted?"10px":"16vh",left:t.submitted?"60px":"50%",transform:t.submitted?"":"translate(-50%)",transition:"1s"},children:Object(r.jsxs)("h1",{style:{fontFamily:"'Heebo', sans-serif",fontSize:t.submitted?"2rem":"4rem"},children:[Object(r.jsx)("span",{style:{color:"#b1e326"},children:"Green"})," Vitals"]})})};function rt(){var t=Object(x.a)(["\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 37px 0 158px 16px;\n  border-color: transparent transparent transparent #fff;\n  position: relative;\n  top: ",";\n  left: ",";\n  z-index: 3;\n  transform: rotate(","deg);\n"]);return rt=function(){return t},t}function at(){var t=Object(x.a)(["\n  position: absolute;\n  height: 400px;\n  width: 400px;\n  top: -20px;\n  animation: "," 2.5s linear infinite;\n  z-index: 3;\n"]);return at=function(){return t},t}function it(){var t=Object(x.a)(["\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return it=function(){return t},t}function ct(){var t=Object(x.a)(['\n  height: 280px;\n  width: 17px;\n  background: linear-gradient(to left, #b1b1b1, #fff);\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%);\n  top: 30%;\n  z-index: 2;\n  border-radius: 0 0 20px 20px;\n\n  :before {\n    content: "";\n    display: block;\n    width: 35px;\n    height: 35px;\n    border-radius: 50%;\n    position: relative;\n    top: -15px;\n    left: 0px;\n    transform: translateX(-25%);\n    background: #fff;\n  }\n']);return ct=function(){return t},t}function ot(){var t=Object(x.a)(["\n  height: 600px;\n  width: 400px;\n  position: absolute;\n  overflow: hidden;\n  box-sizing: content-box;\n  top: ",';\n  left: 50%;\n  transform: translate(-50%);\n  transition: 1.5s;\n\n  :after {\n    content: "";\n    display: block;\n    width: 400px;\n    height: 400px;\n    background: linear-gradient(#d3ff84, #3e7e00);\n    position: relative;\n    top: 70%;\n    border-radius: 50%;\n  }\n']);return ot=function(){return t},t}var st=v.b.div(ot(),(function(t){return t.show?"135vh":"40vh"})),ut=v.b.div(ct()),lt=Object(v.c)(it()),ft=v.b.div(at(),lt),dt=v.b.div(rt(),(function(t){return t.top}),(function(t){return t.left}),(function(t){return t.rotation})),bt=function(t){return Object(r.jsxs)(st,{show:t.submitted,children:[Object(r.jsxs)(ft,{children:[Object(r.jsx)(dt,{top:"50%",left:"200px",rotation:"0"}),Object(r.jsx)(dt,{top:"-130px",left:"108px",rotation:"120"}),Object(r.jsx)(dt,{top:"-340px",left:"272px",rotation:"240"})]}),Object(r.jsx)(ut,{})]})},pt=function(){var t=Object(a.useState)(!1),n=Object(f.a)(t,2),e=n[0],i=n[1],c=Object(a.useState)(!1),o=Object(f.a)(c,2),s=o[0],d=o[1],b=Object(a.useState)(),p=Object(f.a)(b,2),h=p[0],x=p[1],v=Object(a.useState)(),m=Object(f.a)(v,2),g=m[0],y=m[1],w=Object(a.useState)({admin_district:"",outcode:"",latitude:"",longitude:""}),k=Object(f.a)(w,2),z=k[0],S=k[1];Object(a.useEffect)((function(){s&&A()}),[s,z]);var A=function(){var t=Object(l.a)(u.a.mark((function t(){var n,e,r,a,c,o,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i(!0),n=z.outcode,e=z.latitude,r=z.longitude,t.next=5,Promise.all([j.fetchPollutionData(e,r),j.fetchEnergeyData(n)]);case 5:a=t.sent,c=Object(f.a)(a,2),o=c[0],s=c[1],x(s),y(o),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.error(t.t0);case 16:return t.prev=16,i(!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(){return t.apply(this,arguments)}}();return Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)(O,{}),e&&Object(r.jsx)(N,{}),Object(r.jsxs)("div",{style:{maxWidth:"1100px",margin:"auto"},children:[Object(r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(r.jsx)(et,{submitted:s}),Object(r.jsx)(D,{setLocationData:S,setSubmitted:d})]}),Object(r.jsxs)("div",{style:{margin:"120px auto 0 auto"},children:[!e&&Object(r.jsx)("h2",{style:{marginLeft:"1rem"},children:z.admin_district}),!e&&h&&Object(r.jsx)(J,{data:h}),!e&&g&&Object(r.jsx)(nt,{data:g})]}),Object(r.jsx)(bt,{submitted:s})]})]})};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(pt,{})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.63b6c882.chunk.js.map