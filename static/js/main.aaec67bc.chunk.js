(this["webpackJsonpcarbon-intensity"]=this["webpackJsonpcarbon-intensity"]||[]).push([[0],{54:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(1),i=n.n(a),c=n(23),o=n.n(c),u=n(5),s=n.n(u),l=n(7),f=n(6),d=n(10),b=n.n(d),j=function(){var t=Object(l.a)(s.a.mark((function t(e){var n,r,a,i,c,o,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.replace(/\s/g,""),t.next=4,b.a.get("https://api.postcodes.io/postcodes/".concat(n));case 4:return r=t.sent,a=r.data.result,i=a.admin_district,c=a.outcode,o=a.latitude,u=a.longitude,t.abrupt("return",{admin_district:i,outcode:c,latitude:o,longitude:u});case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=Object(l.a)(s.a.mark((function t(e){var n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=(new Date).toISOString(),t.next=4,b.a.get("https://api.carbonintensity.org.uk/regional/intensity/".concat(n,"/fw48h/postcode/").concat(e));case 4:return r=t.sent,console.log(r.data.data.data[0]),t.abrupt("return",r.data.data.data[0]);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),p={fetchLocationData:j,fetchPollutionData:function(){var t=Object(l.a)(s.a.mark((function t(e,n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.get("https://cors-anywhere.herokuapp.com/http://api.openweathermap.org/data/2.5/air_pollution?lat=".concat(e,"&lon=").concat(n,"&appid=3d1641233d5dc6224b739cf77d08866e"));case 3:return r=t.sent,t.abrupt("return",r.data.list[0]);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}(),fetchEnergeyData:h},x=n(2),m=n(3);function O(){var t=Object(x.a)(["\n  body {\n    background: #3d71a0;\n    font-family: 'Inder', sans-serif;\n    color: #fff;\n  }\n\n  h2 {\n    font-size: 2rem;\n  }\n\n  h3 {\n    font-size: 1.5rem;\n  }\n\n  h4 {\n    font-size: 1.4rem;\n    font-weight: 500;\n  }\n\n  * {\n    padding: 0;\n    margin: 0;\n    box-sizing: border-box;\n  }\n"]);return O=function(){return t},t}var v=Object(m.a)(O());function g(){var t=Object(x.a)(["\n  border-radius: 0;\n  border: none;\n  padding: 0.6rem 1.6rem;\n  font-size: 1.1em;\n  border-radius: 35px 0 0 35px;\n  width: 100%;\n  color: #5c5c5c;\n  caret-color: #8f8f8f;\n"]);return g=function(){return t},t}function y(){var t=Object(x.a)(["\n  border: none;\n  background-color: #00abff;\n  color: #fff;\n  padding: 0.3em 0.5em;\n  cursor: pointer;\n  border-radius: 0 35px 35px 0;\n  font-size: 0.8em;\n"]);return y=function(){return t},t}function w(){var t=Object(x.a)(["\n  position: absolute;\n  top: ",";\n  left: 50%;\n  font-size: ",";\n  width: ",";\n  transform: translate(-50%);\n  transition: 1s;\n"]);return w=function(){return t},t}var S=/^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z]))))\s?[0-9][A-Za-z]{2})$/,k=m.b.div(w(),(function(t){return t.style.top}),(function(t){return t.style.fontSize}),(function(t){return t.style.width})),z=m.b.button(y()),A=m.b.input(g()),C=function(t){var e=t.setLocationData,n=t.setSubmitted,i=Object(a.useRef)(null),c=Object(a.useState)(""),o=Object(f.a)(c,2),u=o[0],d=o[1],b=Object(a.useState)(""),j=Object(f.a)(b,2),h=j[0],x=j[1],m=Object(a.useState)({top:"40%",fontSize:"1.8rem",width:"200px"}),O=Object(f.a)(m,2),v=O[0],g=O[1];Object(a.useEffect)((function(){i.current.focus()}),[]);var y=function(){var t=Object(l.a)(s.a.mark((function t(r){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),t.prev=1,S.test(h)){t.next=4;break}throw"Please enter a full, valid UK postcode";case 4:return t.next=6,p.fetchLocationData(h);case 6:a=t.sent,d(""),g({top:"40px",fontSize:"1.5rem",width:"150px"}),e(a),n(!0),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),console.error(t.t0),d(t.t0);case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}();return Object(r.jsxs)(k,{style:v,children:[Object(r.jsxs)("form",{style:{display:"flex",justifyContent:"center"},onSubmit:function(t){return y(t)},autoComplete:"off",children:[Object(r.jsx)(A,{ref:i,"aria-label":"post-code",type:"text",name:"postCode",placeholder:"Postcode",value:h,onChange:function(t){return function(t){x(t.target.value.toUpperCase())}(t)}}),Object(r.jsx)(z,{children:"Submit"})]}),Object(r.jsx)("p",{style:{fontSize:".6em",textAlign:"center"},children:u})]})},P=function(t){var e=t.data,n=t.chartColours,i=Object(a.useRef)(null);Object(a.useEffect)((function(){var t=i.current.getContext("2d");c(t)}),[e]);var c=function(t){u(t);var n=0;e.forEach((function(e){o(t,n,e),n+=e.radians}))},o=function(t,e,r){var a=r.label,c=r.value,o=r.radians,u=i.current,s=u.width/2,l=u.height/2,f=u.height/2*.75,d=e+o;t.beginPath(),t.moveTo(s,l),t.arc(s,l,f,e,d,!1),t.closePath(),t.fillStyle=n[a],t.fill();var b=e+(d-e)/2,j=1.1*f,h=s+j*Math.cos(b),p=l+j*Math.sin(b);t.font=".9rem arial",t.fontWeight="400",t.fillStyle="#fff",t.textAlign=h<s?"right":"left",t.fillText("".concat(a,": ").concat(c,"%"),h,p)},u=function(t){var e=i.current;t.clearRect(0,0,e.width,e.height)};return Object(r.jsx)("div",{children:Object(r.jsx)("canvas",{ref:i,width:"520",height:"400"})})},D=n(27),E=n(9),T=function(t){var e=t.data,n=t.headings,i=Object(E.useMediaQuery)({maxWidth:800});return Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:i?"80%":"30%",margin:"0 .5rem"},children:[Object(r.jsx)("div",{children:Object(r.jsx)("h4",{children:n[0]})}),Object(r.jsx)("div",{style:{textAlign:"right"},children:Object(r.jsx)("h4",{children:n[1]})}),e.map((function(t){return Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("div",{children:Object(D.capitalize)(t[0])}),Object(r.jsx)("div",{style:{textAlign:"right"},children:t[1]})]})}))]})},I=function(t){var e=t.children,n=Object(E.useMediaQuery)({maxWidth:800});return Object(r.jsx)("div",{style:{display:"flex",flexDirection:n?"column":"row",justifyContent:n?"center":"space-between",alignItems:n?"center":"stretch"},children:e})};function M(){var t=Object(x.a)(["\n  border-top: 1px solid #fff;\n  padding: 0.5rem 0;\n  animation: ",";\n  animation-duration: 0.5s;\n  animation-iteration-count: 1;\n  animation-timing-function: ease;\n"]);return M=function(){return t},t}function R(){var t=Object(x.a)(["\n  0% {margin-left: -100vw;}\n  100% {margin: 0;} \n"]);return R=function(){return t},t}var Z={biomass:"#79db88",solar:"#ffb555",wind:"#a8d6ff",hydro:"#00abff",coal:"#443636",nuclear:"#5de6c6",imports:"#e65d5d",gas:"#8d7cdf",other:"#eb2bee"},_=Object(m.c)(R()),W=m.b.section(M(),_),F=function(t){var e=t.data,n=Object(a.useCallback)((function(){var t=e.generationmix.filter((function(t){return t.perc>.5})),n=t.reduce((function(t,e){return t+e.perc}),0);return t.map((function(t){return{value:t.perc,label:t.fuel,radians:t.perc/n*(2*Math.PI)}}))}),[e]),i=Object(a.useCallback)((function(){return e.generationmix.sort((function(t,e){return t.perc<e.perc})).map((function(t){return[t.fuel,t.perc]}))}),[e]);return Object(r.jsxs)(W,{children:[Object(r.jsxs)("header",{style:{textAlign:"center"},children:[Object(r.jsx)("h3",{children:"Energy Overview"}),Object(r.jsxs)("p",{children:["Carbon Intensity:"," ","".concat(e.intensity.forecast," (").concat(e.intensity.index,")")]})]}),Object(r.jsxs)(I,{children:[Object(r.jsx)(T,{headings:["Fuel source","%"],data:i()}),Object(r.jsx)(P,{data:n(),chartColours:Z})]})]})};function L(){var t=Object(x.a)(["\n  transform: translateY(-100%) translateX(-50%);\n  animation-delay: -0.9s;\n"]);return L=function(){return t},t}function J(){var t=Object(x.a)(["\n  width: 20px;\n  height: 20px;\n  background: #fff;\n  position: relative;\n  animation: ",";\n  animation-duration: 1.8s;\n  animation-iteration-count: infinite;\n  animation-fill-mode: forwards;\n  animation-timing-function: linear;\n  transform: translateX(-50%);\n"]);return J=function(){return t},t}function Q(){var t=Object(x.a)(["\n  0% {left: 50%; top: 0px; border-radius: 50% 50% 50% 0;}\n  25% {left: 100%; top: 50%; border-radius: 0 50% 50% 50%;}\n  50% {left: 50%; top: 100%; border-radius: 50% 0 50% 50%;}\n  75% {left: 0%; top: 50%; border-radius: 50% 50% 0 50%; }\n  100% {left: 50%; top: 0px; border-radius: 50% 50% 50% 0;}\n\n"]);return Q=function(){return t},t}var Y=Object(m.c)(Q()),q=m.b.div(J(),Y),G=Object(m.b)(q)(L()),H=function(){return Object(r.jsxs)("div",{style:{width:"200px",position:"fixed",bottom:"50%",left:"50%",transform:"translate(-50%)",textAlign:"center"},children:[Object(r.jsxs)("div",{style:{width:"80px",height:"80px",margin:"auto"},children:[Object(r.jsx)(q,{}),Object(r.jsx)(G,{})]}),Object(r.jsx)("div",{style:{marginTop:"40px",fontSize:"1.4rem"},children:Object(r.jsx)("span",{children:"Working on it..."})})]})},N=function(t){var e=t.data,n=t.colours,i=Object(a.useRef)(null),c=30;Object(a.useEffect)((function(){var t=i.current.getContext("2d");o(t)}),[e]);var o=function(t){s(t);var n=10+70*e.length,r=i.current.height-c;t.font=".9rem arial",t.fontWeight="400",t.fillStyle="#fff",t.strokeStyle="#fff",t.textAlign="right",t.beginPath(),t.moveTo(c,r+1),t.lineTo(n+25,r+1),t.stroke(),t.beginPath(),t.moveTo(c,1),t.lineTo(c,r),t.stroke();for(var a=1;a>=0;a-=.15){var o=Math.round(30*a),l=r-r*a;t.fillText(o,25,l)}var f=40;e.forEach((function(e){u(t,r,f,e),f+=70}))},u=function(t,e,r,a){var o=i.current,u=a.value/30*100/100*e,s=r,l=o.height-(u+c);t.fillStyle=n[a.label],t.fillRect(s,l,60,u);var f=s+30,d=l+u+20;t.textAlign="center",t.fillStyle="#fff",t.fillText("".concat(a.label),f,d)},s=function(t){var e=i.current;t.clearRect(0,0,e.width,e.height)};return Object(r.jsx)("canvas",{ref:i,width:"520",height:"400"})};function U(){var t=Object(x.a)(["\n  border-top: 1px solid #fff;\n  padding: 0.5rem 0;\n  animation: ",";\n  animation-duration: 0.5s;\n  animation-iteration-count: 1;\n  animation-timing-function: ease;\n"]);return U=function(){return t},t}function X(){var t=Object(x.a)(["\n  0% {margin-right: -100vw;}\n  100% {margin: 0;} \n"]);return X=function(){return t},t}var B={no:"#79db88",no2:"#ffb555",o3:"#a8d6ff",so2:"#00abff",pm2_5:"#443636",pm10:"#5de6c6",nh3:"#e65d5d"},K={1:"Good",2:"Fair",3:"Moderate",4:"Poor",5:"Very Poor"},V={co:"Carbon monnoxide",no:"Nitrous oxide",no2:"Nitrous dioxide",o3:"Ozone",so2:"Sulphur dioxide",pm2_5:"Fine particulates",pm10:"Coarse particulates",nh3:"Ammonia"},$=Object(m.c)(X()),tt=m.b.section(U(),$),et=function(t){var e=t.data,n=Object(a.useCallback)((function(){return Object.keys(e.components).filter((function(t){return"co"!==t&&"o3"!==t})).map((function(t){return{label:t,value:e.components[t]}})).sort((function(t,e){return t.value<e.value}))}),[e]),i=Object(a.useCallback)((function(){return Object.entries(e.components).map((function(t){var e=Object(f.a)(t,2),n=e[0],r=e[1];return[V[n],r]}))}),[e]);return Object(r.jsxs)(tt,{children:[Object(r.jsxs)("header",{style:{textAlign:"center"},children:[Object(r.jsx)("h3",{children:"Pollution Overview"}),Object(r.jsxs)("p",{children:["Air Quality Index: ","".concat(e.main.aqi," (").concat(K[e.main.aqi],")")]})]}),Object(r.jsxs)(I,{children:[Object(r.jsx)(N,{data:n(),colours:B}),Object(r.jsx)(T,{headings:["Pollutant","\u03bcg/m\xb3"],data:i()})]})]})},nt=function(){var t=Object(a.useState)(!1),e=Object(f.a)(t,2),n=e[0],i=e[1],c=Object(a.useState)(!1),o=Object(f.a)(c,2),u=o[0],d=o[1],b=Object(a.useState)(),j=Object(f.a)(b,2),h=j[0],x=j[1],m=Object(a.useState)(),O=Object(f.a)(m,2),g=O[0],y=O[1],w=Object(a.useState)({admin_district:"",outcode:"",latitude:"",longitude:""}),S=Object(f.a)(w,2),k=S[0],z=S[1];Object(a.useEffect)((function(){u&&A()}),[u,k]);var A=function(){var t=Object(l.a)(s.a.mark((function t(){var e,n,r,a,c,o,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i(!0),e=k.outcode,n=k.latitude,r=k.longitude,t.next=5,Promise.all([p.fetchPollutionData(n,r),p.fetchEnergeyData(e)]);case 5:a=t.sent,c=Object(f.a)(a,2),o=c[0],u=c[1],x(u),y(o),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.error(t.t0);case 16:return t.prev=16,i(!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(){return t.apply(this,arguments)}}();return Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)(v,{}),n&&Object(r.jsx)(H,{}),Object(r.jsxs)("div",{style:{maxWidth:"1100px",margin:"auto"},children:[Object(r.jsx)(C,{setLocationData:z,setSubmitted:d}),Object(r.jsxs)("div",{style:{margin:"140px auto 0 auto"},children:[!n&&Object(r.jsx)("h2",{style:{marginLeft:"1rem"},children:k.admin_district}),!n&&h&&Object(r.jsx)(F,{data:h}),!n&&g&&Object(r.jsx)(et,{data:g})]})]})]})};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(nt,{})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.aaec67bc.chunk.js.map